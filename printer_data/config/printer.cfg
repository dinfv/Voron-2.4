[include mainsail.cfg]
[include homing.cfg]
#[include stealthburner_led_effects_barf.cfg]
[include flap_temp_control.cfg]
[include flap_main.cfg]
[include KAMP_Settings.cfg]
[include moonraker_obico_macros.cfg]
[include H36_combo.cfg]
[save_variables]
filename:~/variables.cfg

[force_move] 
enable_force_move: true 

[mcu]
## Obtain definition by "ls -l /dev/serial/by-id/" then unplug to verify
serial: /dev/serial/by-id/usb-Klipper_stm32f407xx_400048001151333233363732-if00 
restart_method: command
#--------------------------------------------------------------------
##--------------------------------------------------------------------
[printer]
kinematics: corexy
max_velocity: 800  
max_accel: 60000   			#Max 4000
max_z_velocity: 25 			#Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 30
square_corner_velocity: 5.0

#####################################################################
# 	Requisitos Orcaslicer
#####################################################################
# Enable object exclusion
[exclude_object]

# Enable arcs support
[gcode_arcs]
resolution: 0.1

#####################################################################

[stepper_x]
#step_pin:PC14
step_pin: !PC14
dir_pin: !PC13
enable_pin:!PC15
microsteps: 64
rotation_distance: 40
full_steps_per_rotation:200  #set to 400 for 0.9 degree stepper
#endstop_pin:EBB:gpio13
endstop_pin: tmc5160_stepper_x:virtual_endstop
position_min: 0  
position_endstop: 298
position_max: 300
homing_speed: 85
homing_retract_dist:0



[stepper_y]
step_pin:!PE5
dir_pin:!PE4
enable_pin:!PC15
microsteps:64
rotation_distance: 40
full_steps_per_rotation:200  #set to 400 for 0.9 degree stepper
endstop_pin: tmc5160_stepper_y:virtual_endstop
#endstop_pin:PA14
position_min: 0
position_endstop:311
position_max:311
homing_speed: 85
homing_retract_dist:0

[stepper_z]
step_pin:PC7
dir_pin:!PC6
enable_pin:!PC8
microsteps:16
rotation_distance:40
full_steps_per_rotation: 200
gear_ratio:80:16
endstop_pin:probe:z_virtual_endstop
position_max: 300
position_min: -15
#subir no home
homing_speed: 8
second_homing_speed: 3
##  Z-position of nozzle (in mm) to z-endstop trigger point relative to print surface (Z0)
##  (+) value = endstop above Z0, (-) value = endstop below
##	Increasing position_endstop brings nozzle closer to the bed
##  After you run Z_ENDSTOP_CALIBRATE, position_endstop will be stored at the very end of your config
#position_endstop:-5

[stepper_z1]
step_pin:PD2
dir_pin:PD1
enable_pin:!PD3
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200
gear_ratio: 80:16


[stepper_z2]
step_pin:PD6
dir_pin:!PD5
enable_pin:!PD7
microsteps:16
rotation_distance: 40
full_steps_per_rotation: 200
gear_ratio: 80:16



[stepper_z3]
step_pin:PE1
dir_pin:PE0
enable_pin: !PE2
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200
gear_ratio: 80:16


[heater_bed]
heater_pin: PB10
sensor_type: NTC 100K MGB18-104F39050L32
sensor_pin: PC3
max_power: 0.55
#control = pid
#pid_kp = 28.475
#pid_ki = 0.974
#pid_kd = 208.225
min_temp: 0
max_temp: 120

#####################################################################
#	Homing and Gantry Adjustment Routines
#####################################################################
[idle_timeout]
timeout: 3600

#[safe_z_home]
#home_xy_position: 150,150 # Change coordinates to the center of your print bed
#speed: 100
#subir a mesa no home
#z_hop: 5
#z_hop_speed: 5

[quad_gantry_level]
gantry_corners:
    -58,-7
    308,318
    ##	Probe points
points:
    30,20
    30,250
    260,250
    260,20
speed: 300
horizontal_move_z: 2
retries: 5
retry_tolerance: 0.009
max_adjust: 30

#####################################################################
# 	Probe
#####################################################################
#[probe]
#pin:PB12
#x_offset: 0
#y_offset: 25.0
#z_offset: 3.6
#speed: 10.0
#samples: 2
#samples_result: median
#sample_retract_dist: 3.0
#samples_tolerance: 0.05
#samples_tolerance_retries: 1

#####################################################################
# LED Control
#####################################################################

#[output_pin caselight ](Use PA9)
##  Chamber Lighting - In 5V-RGB Position
#pin: PA9
#pwm: true
#shutdown_value: 0
#value:100
#cycle_time: 0.01

########################################
# TMC UART configuration
########################################

#[tmc2209 stepper_x]
#uart_pin: PE6
#interpolate: false
#run_current: 0.9
#hold_current: 0.3
#sense_resistor: 0.110
#stealthchop_threshold: 0
#adicionado para testar o sensorless
#home_current: 0.5
#diag_pin: ^PA14
#driver_SGTHRS: 110
#driver_SGTHRS: 135

[tmc5160 stepper_x]
#spi_bus: spi4
cs_pin: PE6
diag1_pin: ^!PA14
run_current: 2.0
hold_current: 1.2
sense_resistor: 0.022
stealthchop_threshold: 0
spi_software_sclk_pin: PE12
spi_software_mosi_pin: PE14
spi_software_miso_pin: PE13
interpolate: true




#[tmc2209 stepper_y]
#uart_pin: PE3
#interpolate: false
#run_current: 0.9
#hold_current: 0.3
#sense_resistor: 0.110
#stealthchop_threshold: 0
#diag_pin: ^PA15
#driver_SGTHRS: 130
#driver_SGTHRS: 125

[tmc5160 stepper_y]
#spi_bus: spi4
cs_pin: PE3
diag1_pin: ^!PA15
run_current: 2.0
hold_current: 1.2
sense_resistor: 0.022
stealthchop_threshold: 0
spi_software_sclk_pin: PE12
spi_software_mosi_pin: PE14
spi_software_miso_pin: PE13
interpolate: true



[tmc2209 stepper_z]
uart_pin: PB7
interpolate: true
run_current: 0.8
hold_current: 0.5
stealthchop_threshold: 99999

#[tmc2209 extruder]
#uart_pin: PB3
#interpolate: True
#run_current: 0.6
#hold_current: 0.5
#sense_resistor: 0.110
#stealthchop_threshold: 0

[tmc2209 stepper_z1]
uart_pin: PD4
interpolate: true
run_current: 0.8
hold_current: 0.5
stealthchop_threshold: 99999

[tmc2209 stepper_z2]
uart_pin: PD0
run_current: 0.8
hold_current: 0.5
stealthchop_threshold: 99999
interpolate: true

[tmc2209 stepper_z3]
uart_pin: PD15
run_current: 0.8
hold_current: 0.5
stealthchop_threshold: 99999
interpolate: true

#####################################################################
# 	Macros
#####################################################################

#ALINHAR A MESA
[gcode_macro ALINHAR_MESA]
gcode:
    G28
    QUAD_GANTRY_LEVEL
    G1 X150 Y150 F7000
    
[gcode_macro G32]
gcode:
    BED_MESH_CLEAR
    G28
    QUAD_GANTRY_LEVEL
    G28
    ##	Uncomment for for your size printer:
    #--------------------------------------------------------------------
    ##	Uncomment for 250mm build
    #G0 X115 Y115 Z30 F3600
    
    ##	Uncomment for 300 build
    G0 X150 Y150 Z30 F3600
    
    ##	Uncomment for 350mm build
    #G0 X175 Y175 Z30 F3600
    #--------------------------------------------------------------------
    
    #[gcode_macro PRINT_START]
    #   Use PRINT_START for the slicer starting script - please customise for your slicer of choice
    #gcode:
    #G32                            ; home all axes
    #G1 Z10 F3000                   ; move nozzle away from bed
    #PROBE_EDDY_NG_TAP
    #BED_MESH_CALIBRATE METHOD=rapid_scan
    
    #M117 Purge...
    #G92 E0;
    #G90
    #G0 X55 Y2 F6000
    #G0 Z0.55
    #G91
    #G1 X170 E30 F1200;
    #G1 Y1
    #G1 X-170 E30 F1200;
    
    #M117 Imprimindo...
    
    
#[gcode_macro PRINT_START]    
#description: 
#variable_state: 'Prepare'
#variable_record_extruder_temp: 0
#variable_max_record_extruder_temp: 0

#gcode:
#    {% set speed = printer.configfile.settings.printer.max_velocity %}
#    {% set x_max = printer.toolhead.axis_maximum.x %}
#    {% set y_max = printer.toolhead.axis_maximum.y %}
#    {% set extruder_target_temp = printer.extruder.target|int %}
#    {% set bed_targer_temp = printer.heater_bed.target|int %}
#    
#    M400
#    CLEAR_PAUSE
#    G90
#    
#    {% if state == 'Prepare' %}
#    {action_respond_info("Prepare!")}
#    
#    {% if printer.toolhead.homed_axes|lower != "xyz" %}
    #status_homing
#    G28
#    {% endif %}
#    
#    {% if printer['filament_switch_sensor filament_sense'].enable == True and
#    printer['filament_switch_sensor filament_sense'].filament_detected != True %}
#    M117 No filament!!!
#    {action_respond_info("Please Insert filament in Sensor!")}
#    CANCEL_PRINT
#    {% endif %}
#    
#    {action_respond_info("Check Heating!")}
#    
#    M140 S{bed_targer_temp}
#    M104 S{extruder_target_temp}
#    
#    {% if printer.heater_bed.temperature < bed_targer_temp %}
#    M117 Bed heating...
#    {action_respond_info("Bed heating...")}
#    #status_heating
#    M190 S{bed_targer_temp}
#    {% endif %}
#    
#    {% if printer.extruder.temperature < extruder_target_temp %}
#    M117 Nozzle heating...
#    {action_respond_info("Nozzle heating...")}
#    #status_heating
#    M109 S{extruder_target_temp}
#    {% endif %}
#    
#    #status_leveling
#    QUAD_GANTRY_LEVEL
#    
#    ; Position for cleaning
#    #G0 X{x_max} Y{y_max} Z15 F{speed*60}
    
    ; Cool nozzle slightly before cleaning
#    M104 S150
#    M109 S150
    #status_cleaning
    
    
    
    ; ðŸ§¼ Nozzle Cleaning
#    CLEAN_NOZZLE
    
#    G0 x150 y150 F3000
    
    ; ðŸ”½ TAP Z Probing
    #status_calibrating_z
#    CARTOGRAPHER_TOUCH #TARGET_Z=-0.359 THRESHOLD=1000
    
    ; ðŸ§­ Adaptive Mesh
    #status_meshing
#    BED_MESH_CALIBRATE METHOD=rapid_scan ADAPTIVE=1
#    
    #SET_GCODE_VARIABLE MACRO=PRINT_START VARIABLE=state VALUE='"Start"'
    #UPDATE_DELAYED_GCODE ID=_print_start_wait DURATION=0.5
    
#    {% elif state == 'Start' %}
#    M117 Printing now!!!
#    {action_respond_info("Start!")}
#    {% endif %}
    #status_printing


#####################################################################
#   A better print_start macro for v2/trident
#####################################################################

## *** THINGS TO UNCOMMENT: ***
## Bed mesh (2 lines at 2 locations)
## Nevermore (if you have one)
## Z_TILT_ADJUST (For Trident only)
## QUAD_GANTRY_LEVEL (For V2.4 only)

[gcode_macro PRINT_START]
gcode:
  # This part fetches data from your slicer. Such as bed, extruder, and chamber temps and size of your printer.
  {% set target_bed = params.BED|int %}
  {% set target_extruder = params.EXTRUDER|int %}
  {% set target_chamber = params.CHAMBER|default("45")|int %}
  {% set x_wait = printer.toolhead.axis_maximum.x|float / 2 %}
  {% set y_wait = printer.toolhead.axis_maximum.y|float / 2 %}

  SET_GCODE_OFFSET Z=0                                 # Set offset to 0

  # Home the printer, set absolute positioning and update the Stealthburner LEDs.
  #STATUS_HOMING                                         # Set LEDs to homing-mode
  G28                                                   # Full home (XYZ)
  G90                                                   # Absolute position

  ##  Uncomment for bed mesh (1 of 2 for bed mesh)
  BED_MESH_CLEAR                                       # Clear old saved bed mesh (if any)

  # Check if the bed temp is higher than 90c - if so then trigger a heatsoak.
  {% if params.BED|int > 90 %}
    SET_DISPLAY_TEXT MSG="Bed: {target_bed}c"           # Display info on display
    #STATUS_HEATING                                      # Set LEDs to heating-mode
    M106 S255                                           # Turn on the PT-fan

    ##  Uncomment if you have a Nevermore.
    #SET_PIN PIN=nevermore VALUE=1                      # Turn on the nevermore

    G1 X{x_wait} Y{y_wait} Z15 F9000                    # Go to center of the bed
    M190 S{target_bed}                                  # Set the target temp for the bed
    SET_DISPLAY_TEXT MSG="Heatsoak: {target_chamber}c"  # Display info on display
    #TEMPERATURE_WAIT SENSOR="temperature_sensor chamber" MINIMUM={target_chamber}   # Waits for chamber temp

  # If the bed temp is not over 90c, then skip the heatsoak and just heat up to set temp with a 5 min soak
  {% else %}
    SET_DISPLAY_TEXT MSG="Bed: {target_bed}c"           # Display info on display
    #STATUS_HEATING                                      # Set LEDs to heating-mode
    G1 X{x_wait} Y{y_wait} Z15 F9000                    # Go to center of the bed
    M190 S{target_bed}                                  # Set the target temp for the bed
    #SET_DISPLAY_TEXT MSG="Soak for 5 min"               # Display info on display
    #G4 P300000                                          # Wait 5 min for the bedtemp to stabilize
  {% endif %}

  # Heat hotend to 150c. This helps with getting a correct Z-home.
  SET_DISPLAY_TEXT MSG="Hotend: 150c"                   # Display info on display
  M109 S150                                             # Heat hotend to 150c

  ##  Uncomment for Trident (Z_TILT_ADJUST)
  #SET_DISPLAY_TEXT MSG="Leveling"                      # Display info on display
  #STATUS_LEVELING                                      # Set LEDs to leveling-mode
  #Z_TILT_ADJUST                                        # Level the printer via Z_TILT_ADJUST
  #G28 Z                                                # Home Z again after Z_TILT_ADJUST

  ##  Uncomment for V2.4 (Quad gantry level AKA QGL)
  SET_DISPLAY_TEXT MSG="Leveling"                      # Display info on display
  #STATUS_LEVELING                                      # Set LEDs to leveling-mode
  QUAD_GANTRY_LEVEL                                    # Level the printer via QGL
  G28 Z                                                # Home Z again after QGL

  ##  Uncomment for bed mesh (2 of 2 for bed mesh)
  SET_DISPLAY_TEXT MSG="Bed mesh"                      # Display info on display
  #STATUS_MESHING                                       # Set LEDs to bed mesh-mode
  BED_MESH_CALIBRATE ADAPTIVE=1                                 # Start the bed mesh (add ADAPTIVE=1) for adaptive bed mesh

  CARTOGRAPHER_TOUCH                                    # Calibrate z offset only with hot nozzle

  # Heat up the hotend up to target via data from slicer
  SET_DISPLAY_TEXT MSG="Hotend: {target_extruder}c"     # Display info on display
  #STATUS_HEATING                                        # Set LEDs to heating-mode
  G1 X{x_wait} Y{y_wait} Z15 F9000                      # Go to center of the bed
  M107                                                  # Turn off partcooling fan
  M109 S{target_extruder}                               # Heat the hotend to set temp

  # Get ready to print by doing a primeline and updating the LEDs
  SET_DISPLAY_TEXT MSG="Printer goes brr"               # Display info on display
  #STATUS_PRINTING                                       # Set LEDs to printing-mode
  #G0 X{x_wait - 50} Y4 F10000                           # Go to starting point
  #G0 Z0.4                                               # Raise Z to 0.4
  #G91                                                   # Incremental positioning 
  #G1 X100 E20 F1000                                     # Primeline
  #G90                                                   # Absolute position
    
    
[gcode_macro PRINT_END]
#   Use PRINT_END for the slicer ending script - please customise for your slicer of choice
gcode:
    M400                           ; wait for buffer to clear
    G92 E0                         ; zero the extruder
    G1 E-10.0 F3600                ; retract filament
    G91                            ; relative positioning
    G0 Z1.00 X20.0 Y20.0 F20000    ; move nozzle to remove stringing
    TURN_OFF_HEATERS
    #status_cooling
    M107                           ; turn off fan
    G1 Z5 F3000                    ; move nozzle up 2mm
    G90                            ; absolute positioning
    G0  X125 Y250 F3600            ; park nozzle at rear
    BED_MESH_CLEAR
    PROBE_EDDY_NG_SET_TAP_OFFSET VALUE=0
    #status_ready
    
    
    #z_offset = 3.600
    
[virtual_sdcard]
path: /home/voron/printer_data/gcodes

[pause_resume]

[gcode_macro CANCEL_PRINT]
description: Cancel the actual running print
rename_existing: CANCEL_PRINT_BASE
gcode:
    TURN_OFF_HEATERS
    CANCEL_PRINT_BASE
    
[gcode_macro QUAD_GANTRY_LEVEL]
rename_existing: BASE_QUAD_GANTRY_LEVEL
gcode:
    # Pass 1: Initial Coarse Leveling
    BASE_QUAD_GANTRY_LEVEL HORIZONTAL_MOVE_Z=10 RETRY_TOLERANCE=1
    # Pass 2: Fine Leveling and Accuracy
    BASE_QUAD_GANTRY_LEVEL HORIZONTAL_MOVE_Z=2
    
    
[display_status]

#####################################################################
#   Sensores de Temperatura
#####################################################################

[temperature_sensor Cabine]
sensor_type: Generic 3950
sensor_pin: PC2

[temperature_sensor Eletronica]
sensor_type: Generic 3950
sensor_pin: PC1

[temperature_sensor Btt Pi2]
sensor_type: temperature_host
min_temp: 0
max_temp: 100

[temperature_sensor MKS_Monster 8]
sensor_type: temperature_mcu

[gcode_macro testar_impressao]
#   Use PRINT_START for the slicer starting script - PLEASE CUSTOMISE THE SCRIPT
gcode:
    
    
    M117 Purge...
    G92 E0;
    G90
    G0 X55 Y2 F6000
    G0 Z0.55
    G91
    G1 X170 E30 F1200;
    G1 Y1
    G1 X-170 E30 F1200;

########################################### CARTOGRAPHER ###########################################################################

[mcu scanner] 
serial: /dev/serial/by-id/usb-Cartographer_614e_1C0021001643304B4E363120-if00

[scanner]
mcu: scanner            
#   Offsets are measured from the centre of your coil, to the tip of your nozzle 
#   on a level axis. It is vital that this is accurate. 
x_offset: 0                          
#    adjust for your cartographers offset from nozzle to middle of coil
y_offset: 20                         
#    adjust for your cartographers offset from nozzle to middle of coil
backlash_comp: 0.05124
#   Backlash compensation distance for removing Z backlash before measuring
#   the sensor response.
sensor: cartographer
#    this must be set as cartographer unless using IDM etc.
sensor_alt: carto
#    alternate name to call commands. CARTO_TOUCH etc      
mesh_runs: 2
#    Number of passes to make during mesh scan.

[bed_mesh]
zero_reference_position: 150, 150    
#    set this to the middle of your bed
speed: 200
#    movement speed of toolhead during bed mesh
horizontal_move_z: 5
#    height of scanner during bed mesh scan
mesh_min: 20, 22
#    start point of bed mesh [X, Y]
mesh_max: 280, 260
#    end point of bed mesh [X, Y]
probe_count: 30, 30
algorithm: bicubic

[temperature_sensor Cartographer_MCU]
sensor_type: temperature_mcu
sensor_mcu: scanner
min_temp: 0
max_temp: 105

[lis2dw]
cs_pin: scanner:PA3
spi_bus: spi1

[resonance_tester]
accel_chip: lis2dw
probe_points:
    150, 150, 20

    
    
################################### EDDY ##############################################
    
#[mcu eddy]
# FOR USB: replace this with your serial port ID
#serial: /dev/serial/by-id/usb-Klipper_rp2040_504450612047D51C-if00
#restart_method: command

#[probe_eddy_ng btt_eddy]
#sensor_type: btt_eddy
#i2c_mcu: eddy
#i2c_bus: i2c0f
#x_offset: 0 # INSERT VALUE FOR YOUR PROBE POSITION
#y_offset: 21.42 # INSERT VALUE FOR YOUR PROBE POSITION 

#[temperature_sensor btt_eddy_mcu]
#sensor_type: temperature_mcu
#sensor_mcu: eddy
#min_temp: 10
#max_temp: 108

#[temperature_sensor btt_eddy]
#sensor_type: Generic 3950
#sensor_pin: eddy:gpio26

#[bed_mesh]
#horizontal_move_z: 2
#speed: 150
#mesh_min: 20, 22  # modify these according to the above guide. If the probe cannot reach then you will get a klipper error when trying to scan a bed mesh.
#mesh_max: 280, 260 # modify these according to the above guide. If the probe cannot reach then you will get a klipper error when trying to scan a bed mesh.
#probe_count: 9, 9
#algorithm: bicubic
#scan_overshoot: 8  #uncomment this section if you still have room left over on the X axis for some scan overshoot to product smoother movements and more accurate scanning. Uncommenting this should be fine if you are using a standard voron mount.

####################################################################################################################

[temperature_fan _Fan_1]
pin: PA2
max_power: 0.4
shutdown_speed: 0.0
control: watermark
max_delta: 5.0
sensor_type: temperature_host
#sensor_mcu: mcu
min_temp: 0
max_temp: 100
target_temp: 65

[temperature_fan _Fan_2]
pin: PA1
max_power: 0.4
shutdown_speed: 0.0
control: watermark
max_delta: 5.0
sensor_type: temperature_host
#sensor_mcu: mcu
min_temp: 0
max_temp: 100
target_temp: 65

[neopixel caselight]
pin: PA8
chain_count: 36
color_order: GRB
initial_RED: 1
initial_GREEN: 1
initial_BLUE: 1
initial_WHITE: 1


######LIMPAR BICO#########
[gcode_macro CLEAN_NOZZLE]
variable_start_x: 275
variable_start_y: 311
variable_start_z: 4.5
variable_wipe_dist: -40
variable_wipe_qty: 10
variable_wipe_spd: 200
variable_raise_distance: 30

gcode:
    
    {% if "xyz" not in printer.toolhead.homed_axes %}
    G28
    {% endif %}
    #status_cleaning
    G90                                            ; absolute positioning
    ## Move nozzle to start position
    G1 X{start_x} Y{start_y} F6000
    G1 Z{start_z} F1500
    
    ## Wipe nozzle
    {% for wipes in range(1, (wipe_qty + 1)) %}
    G1 X{start_x + wipe_dist} F{wipe_spd * 60}
    G1 X{start_x} F{wipe_spd * 60}
    {% endfor %}
    
    ## Raise nozzle
    G1 Z{raise_distance}


################################# TEMPERATURAS ##########################################
[gcode_macro M109]
rename_existing: M99109
gcode:
    #Parameters
    {% set s = params.S|float %}
    
    M104 {% for p in params %}{'%s%s' % (p, params[p])}{% endfor %}  ; Set hotend temp
    {% if s != 0 %}
        TEMPERATURE_WAIT SENSOR=extruder MINIMUM={s} MAXIMUM={s+1}   ; Wait for hotend temp (within 1 degree)
    {% endif %}



[gcode_macro M190]
rename_existing: M99190
gcode:
    #Parameters
    {% set s = params.S|float %}

    M140 {% for p in params %}{'%s%s' % (p, params[p])}{% endfor %}   ; Set bed temp
    {% if s != 0 %}
        TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={s} MAXIMUM={s+1}  ; Wait for bed temp (within 1 degree)
    {% endif %}
    

########################SHAKE&TUNE######################################
[shaketune]
# result_folder: ~/printer_data/config/ShakeTune_results
#    Path where the processed results will be stored. If the folder doesn't exist,
#    it will be automatically created. You can change this if you'd like to store 
#    results in a different location.
# number_of_results_to_keep: 10
#    This setting defines how many results you want to keep in the result folder.
#    Once the specified number is exceeded, older results will be automatically deleted
#    to free up space on the SD card and avoid cluttering the results folder.
# keep_raw_data: False
#    If set to True, Shake&Tune will store both the processed graphs and the raw accelerometer
#    .stdata files in the results folder. This can be useful for debugging or archiving purposes.
#    Please always attach them when reporting any issues on GitHub or Discord.
# show_macros_in_webui: True
#    Mainsail and Fluidd doesn't create buttons for system commands (macros that are not part
#    of the printer.cfg file). This option allow Shake&Tune to inject them into the webui at runtime.
#    If set to False, the macros will be hidden but still accessible from the console by typing
#    their names manually, which can be useful if you prefer to encapsulate them into your own macros.
# timeout: 600
#    This defines the maximum processing time (in seconds) to allows to Shake&Tune for generating 
#    graphs from a .stdata file. 10 minutes should be more than enough in most cases, but if you have
#    slower hardware (e.g., older SD cards or low-performance devices), increase it to prevent timeouts.
# measurements_chunk_size: 2
#    Each Shake&Tune command uses the accelerometer to take multiple measurements. By default,
#    Shake&Tune will write a chunk of data to disk every two measurements, and at the end of the
#    command will merge these chunks into the final .stdata file for processing. "2" is a very
#    conservative setting to avoid Klipper Timer Too Close errors on lower end devices with little
#    RAM, and should work for everyone. However, if you are using a powerful computer, you may
#    wish to increase this value to keep more measurements in memory (e.g., 15-20) before writing
#    the chunk and avoid stressing the filesystem too much.
# max_freq: 200
#    This setting defines the maximum frequency at which the calculation of the power spectral density
#    is cutoff. The default value should be fine for most machines and accelerometer combinations and
#    avoid touching it unless you know what you're doing.
# dpi: 300
#    Controls the resolution of the generated graphs. The default value of 300 dpi was optimized
#    and strikes a balance between performance and readability, ensuring that graphs are clear
#    without using too much RAM to generate them. Usually, you shouldn't need to change this value.

##################################################################################################################
 #    NEVERMORE
##################################################################################################################

[heater_fan Nevermore] # fan2
pin: PA0
heater: heater_bed
heater_temp: 60.0
    
    
    
####################################TMC AUTOTUNE###############################################################
[autotune_tmc stepper_x]
motor: ldo-42sth48-2804ah
voltage: 45
sgt: 1

[autotune_tmc stepper_y]
motor: ldo-42sth48-2804ah
voltage: 45
sgt: 1

[autotune_tmc stepper_z]
motor: hanpose-17hs4401

[autotune_tmc stepper_z1]
motor: hanpose-17hs4401

[autotune_tmc stepper_z2]
motor: hanpose-17hs4401

[autotune_tmc stepper_z3]
motor: hanpose-17hs4401

[autotune_tmc extruder]
motor: ldo-36sth20-1004ahg

#################################################SENSOR FILAMENTO########################################################################

#[filament_switch_sensor switch_sensor]
#switch_pin: ^PB12
#pause_on_runout: False
#runout_gcode:
# PAUSE # [pause_resume] is required in printer.cfg
# M117 Filament switch runout
#insert_gcode:
# M117 Filament switch inserted

[filament_motion_sensor encoder_sensor]
switch_pin: ^PB13
detection_length: 15.0 # accuracy of motion sensor 2.88mm
extruder: extruder
pause_on_runout: False
runout_gcode:
    PAUSE # [pause_resume] is required in printer.cfg
    M117 Filament encoder runout
insert_gcode:
    M117 Filament encoder inserted
    
[auto_speed]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 57.4
#*# shaper_type_y = mzv
#*# shaper_freq_y = 41.0
#*#
#*# [probe_eddy_ng btt_eddy]
#*# calibrated_drive_currents = 16, 17, 15
#*# calibration_version = 5
#*# reg_drive_current = 16
#*# tap_drive_current = 17
#*# calibration_16 = gASVygMAAAAAAAB9lCiMAXaUSwWMBGZ0b2iUjBtudW1weS5wb2x5bm9taWFsLnBvbHlub21pYWyUjApQb2x5bm9taWFslJOUKYGUfZQojARjb2VmlIwVbnVtcHkuY29yZS5tdWx0aWFycmF5lIwMX3JlY29uc3RydWN0lJOUjAVudW1weZSMB25kYXJyYXmUk5RLAIWUQwFilIeUUpQoSwFLCoWUaAyMBWR0eXBllJOUjAJmOJSJiIeUUpQoSwOMATyUTk5OSv////9K/////0sAdJRiiUNQR08f+Tf2+D9viA92h4L8Pxe2sUULYOU/2QsDoc1n4z/raZUydRHFP3Pz7yMF/eC//LJynzNbuj+2Pa/OK+LsP0raodc5J68/xw4hXJwy1b+UdJRijAZkb21haW6UaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxDAvmD/ibGUPuppZLoJIZU+lHSUYowGd2luZG93lGgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQAAAAAAAA8L8AAAAAAADwP5R0lGKMB19zeW1ib2yUjAF4lIwGc3ltYm9slGgsdWKMCWZ0b2hfaGlnaJRoBSmBlH2UKGgIaAtoDksAhZRoEIeUUpQoSwFLCoWUaBiJQ1Bh46az84UaQBc9XcFgVAlA1wU7rSjI+j/T+ZkVn+3sP012YPa1sek/fwfBKo6i7j+Na7J3tUq/v7owmGD9vN2/N3VCgRlb7T9IcM0H3TbqP5R0lGJoHWgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQGei+VUAdlT5ERX6M/jaVPpR0lGJoJGgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQAAAAAAAA8L8AAAAAAADwP5R0lGJoK2gsaC1oLHVijARodG9mlGgFKYGUfZQoaAhoC2gOSwCFlGgQh5RSlChLAUsKhZRoGIlDUCJHa8VyApU+KM5lkPJ6KD7C9ZpK3uYZvv3XiJ/bjwg+TwSatCS7671gG66bIgoDvp7TJLlw9PQ9PAykcVqE/T3FwL7y++XRvU5QGVv4yOm9lHSUYmgdaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxDgFW+rXea+P1ZHU9009xNAlHSUYmgkaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxAAAAAAAADwvwAAAAAAAPA/lHSUYmgraCxoLWgsdWKMB2hfcmFuZ2WUXZQoRz++5l2rbxXgR0At///ZpHc0ZYwHZl9yYW5nZZRdlChHQUgiUnGBCABHQUi990i9aABljAJkY5RLEHUu
#*# calibration_17 = gASVygMAAAAAAAB9lCiMAXaUSwWMBGZ0b2iUjBtudW1weS5wb2x5bm9taWFsLnBvbHlub21pYWyUjApQb2x5bm9taWFslJOUKYGUfZQojARjb2VmlIwVbnVtcHkuY29yZS5tdWx0aWFycmF5lIwMX3JlY29uc3RydWN0lJOUjAVudW1weZSMB25kYXJyYXmUk5RLAIWUQwFilIeUUpQoSwFLCoWUaAyMBWR0eXBllJOUjAJmOJSJiIeUUpQoSwOMATyUTk5OSv////9K/////0sAdJRiiUNQFzDh335F9T9Q+xzG3QX8P0syh10Xmec/F9G43Dg34D9SWGtNBfvPP3FOKw7LP7M/2vi7cA84pj+GRwpPjgacP1iFyWNsyME/yaDiIBKNwT+UdJRijAZkb21haW6UaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxD/MlZtD7SUPlKVEW2LP5U+lHSUYowGd2luZG93lGgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQAAAAAAAA8L8AAAAAAADwP5R0lGKMB19zeW1ib2yUjAF4lIwGc3ltYm9slGgsdWKMCWZ0b2hfaGlnaJRoBSmBlH2UKGgIaAtoDksAhZRoEIeUUpQoSwFLCoWUaBiJQ1AxTpna37kVQECAbD6XD/E/5Mhnq0xi1j8XkR+y1x3hP1hkrxsbUt2/474P8Xgs97+pdWW0fGDiP+UTLbQifvk/7DtEBl9Oy7+TMse6fjPiv5R0lGJoHWgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQc9Q3uF07lT4fMM1gA0qVPpR0lGJoJGgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQAAAAAAAA8L8AAAAAAADwP5R0lGJoK2gsaC1oLHVijARodG9mlGgFKYGUfZQoaAhoC2gOSwCFlGgQh5RSlChLAUsKhZRoGIlDUDOAjuo9HZU+oMnrV9EtLD5GSTSCWXYgviavc9WA4RI+NotsJUD39L3WTPRho2ANvliDvK/trtI90DSvQhIqEz4WrMu3GPnWPVeYgQOx4gO+lHSUYmgdaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxAAgLYv0bnmPlYmOYKq+RNAlHSUYmgkaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxAAAAAAAADwvwAAAAAAAPA/lHSUYmgraCxoLWgsdWKMB2hfcmFuZ2WUXZQoRz7mudEvtoAAR0AbdIo6qoZWZYwHZl9yYW5nZZRdlChHQUgMwvin8ABHQUi68/KocABljAJkY5RLEXUu
#*# calibration_15 = gASVygMAAAAAAAB9lCiMAXaUSwWMBGZ0b2iUjBtudW1weS5wb2x5bm9taWFsLnBvbHlub21pYWyUjApQb2x5bm9taWFslJOUKYGUfZQojARjb2VmlIwVbnVtcHkuY29yZS5tdWx0aWFycmF5lIwMX3JlY29uc3RydWN0lJOUjAVudW1weZSMB25kYXJyYXmUk5RLAIWUQwFilIeUUpQoSwFLCoWUaAyMBWR0eXBllJOUjAJmOJSJiIeUUpQoSwOMATyUTk5OSv////9K/////0sAdJRiiUNQQy2Wi/cI+z8akh/d5v/9PxCMVXaNF+Q/KBxExU4S3D9cDOn6YNnJP3tBohRYm9G/Oz3+Za2Kvz+6RmX3FMXiPycEjnqih6W/DUxAkfu60L+UdJRijAZkb21haW6UaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxCyxm+99dKUPgaoV1o4DZU+lHSUYowGd2luZG93lGgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQAAAAAAAA8L8AAAAAAADwP5R0lGKMB19zeW1ib2yUjAF4lIwGc3ltYm9slGgsdWKMCWZ0b2hfaGlnaJRoBSmBlH2UKGgIaAtoDksAhZRoEIeUUpQoSwFLCoWUaBiJQ1DhJh2jGjkbQAuOqrSziglAVRs3WoLZ/z8wXTEpKLMRQLXxJmoq+OO/O8zeC3mqKsCHikHjkH8FQHy+xsl1xzRAic3qKc3u7r/TLnL2AIYjwJR0lGJoHWgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQ7inzT/IKlT6Y9zAPChyVPpR0lGJoJGgLaA5LAIWUaBCHlFKUKEsBSwKFlGgYiUMQAAAAAAAA8L8AAAAAAADwP5R0lGJoK2gsaC1oLHVijARodG9mlGgFKYGUfZQoaAhoC2gOSwCFlGgQh5RSlChLAUsKhZRoGIlDULhFr3sr/JQ++347ELvpGT7t67WlZY4IvuxldtVQuPI9lsagGGut1T0XSWb9Ul/4vbC1ooBwwuC9YDNWWPCqAT6of2+ZgsnOPRz2yLZ3sPC9lHSUYmgdaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxD4IJchzv7NP1ZrxCt18RNAlHSUYmgkaAtoDksAhZRoEIeUUpQoSwFLAoWUaBiJQxAAAAAAAADwvwAAAAAAAPA/lHSUYmgraCxoLWgsdWKMB2hfcmFuZ2WUXZQoRz/N/s4hlyD4R0At//7eT37lZYwHZl9yYW5nZZRdlChHQUhBI5/vqABHQUiWQc0nSABljAJkY5RLD3Uu
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 1500
#*# scanner_touch_speed = 3
#*#
#*# [scanner model default]
#*# model_coef = 1.5648677698485063,
#*# 	1.9121656596224388,
#*# 	0.6765423842643782,
#*# 	0.21596183514889936,
#*# 	0.5990454635477198,
#*# 	0.5909848661002586,
#*# 	-0.5686078117859629,
#*# 	-0.5462152298246751,
#*# 	0.37920671119318733,
#*# 	0.2797032028388582
#*# model_domain = 3.2590262714701006e-07,3.347724297929166e-07
#*# model_range = 0.200000,5.100000
#*# model_temp = 27.657350
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.1.0
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 33.470
#*# pid_ki = 1.156
#*# pid_kd = 242.236
